from conexio.conexio import conexion

async def crear_usuario(datos: dict):
    conn = await conexion()
    try:
        query = """
            INSERT INTO usuarios (
                nombre, 
                apellido, 
                email, 
                descripcion, 
                curso, 
                anio, 
                direccion, 
                cp, 
                password
            )
        """
        await conn.execute(
            query,
            datos['nombre'],
            datos['apellido'],
            datos['email'],
            datos['descripcion'],
            datos['curso'],
            datos['ano'],
            datos['direccion'],
            datos['cp'],
            datos['password']
        )
        return {"mensjae": "Hecho con exito"}
    finally:
        await conn.close()
        
        
async def leer_usuario(email: str):
    conn = await conexion()
    try:
        query = """
            SELECT 
                id,
                nombre, 
                apellido, 
                email, 
                curso, 
                ano AS a√±o, 
                direccion
            FROM usuarios
            WHERE email = $1
        """
        return await conn.fetchrow(query, email)
    finally:
        await conn.close()